<html>

<head>
    <title> After School Subjects</title>
    <script src="https://unpkg.com/vue">
    </script>
    <script src="subjects.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
</head>

<body>
    <div id="app">
        <header>
            <h1 v-text="sitename"></h1>
            <button v-on:click='showCheckout'>
                {{cartitemCount}}
                <i class="fas fa-shopping-cart"></i>Checkout
            </button>
        </header>
        <main>
            
            <div v-for="product in subjects">
                <h2 v-text="product.name"></h2>
                <figure>
                    <img v-bind:src="product.image">
                </figure>
                <p v-html="product.location"></p>
                <p> Price: {{product.price}}</p>
                <p> Spaces: {{product.availableInventory - cartCount(product.id)}} </p>
                <button v-on:click='addtoCart(product)' v-if='canAddToCart(product)'>
                    Add to Cart
                </button>
                <button disabled="disabled" v-else>Add to Cart</button>
                <span v-if='product.availableInventory === cartCount(product.id)'>All out!</span>
                <span v-else-if="product.availableInventory - cartCount(product.id) < 5"> 
                    Only {{product.availableInventory - cartCount(product.id)}} left!
                </span>
                <span v-else>Buy now!</span>
                <div>
                    <span v-for='n in product.rating'>★</span>
                    <span v-for='n in 5-product.rating'>☆</span>
                </div>
            </div>
            </div>

        </main>
    </div>
    <script>
        var webstore = new Vue({
            el: "#app",
            data: {
                sitename: "After School Subjects",
                subjects: subjects,
                cart: []
            },
            
            methods: {
                addtoCart (product) {
                    this.cart.push(product.id);
                },
                showCheckout() {
                    this.showProduct = this.showProduct ? false : true;
                },
                submitForm() {
                    alert('Order submitted!')
                },
                canAddToCart(product){
                    return product.availableInventory > this.cartCount(product.id)
                },
                cartCount(id) {
	            let count = 0;
	            for (let i = 0; i < this.cart.length; i++) {
		            if (this.cart[i] === id) {
			        count++;
		        }
	}
	return count;
},

            },
            computed: {
                cartitemCount: function () {
                    return this.cart.length;
                }
                }
        
        });
    </script>

</body>

</html>